## glob

FIS3 中支持的 glob 规则，FIS3 使用 [node-glob](https://github.com/isaacs/node-glob) 提供 glob 支持。

### 简要说明

[node-glob](https://github.com/isaacs/node-glob) 中的使用方式有很多，如果要了解全部，请前往 [node-glob](https://github.com/isaacs/node-glob)。

这里把常用的一些用法做说明。

- `*` 匹配多个除了 `/` 以外的字符
- `?` 匹配单个除了 `/` 以外的字符
- `**` 匹配多个字符**包括 `/`**
- `{}` 可以让多个规则用 `,` 逗号分隔，起到`或者`的作用
- `!` 出现在规则的开头，表示取反。即匹配不命中后面规则的文件

需要注意的是，fis 中的文件路径都是以 `/` 开头的，所以编写规则时，请尽量严格的以 `/` 开头。

当设置规则时，没有严格的以 `/` 开头，比如 `a.js`, 它匹配的是所有目录下面的 `a.js`, 包括：`/a.js`、`/a/a.js`、`/a/b/a.js`。 如果要严格只命中根目录下面的 `/a.js`, 请使用 `fis.match('/a.js')`。


另外 `/foo/*.js`， 只会命中 `/foo` 目录下面的所有 js 文件，不包含子目录。
而 `/foo/**/*.js` 是命中所有子目录以及其子目录下面的所有 js 文件，不包含当前目录下面的 js 文件。
如果需要命中 `foo` 目录下面以及所有其子目录下面的 js 文件，请使用 `/foo/**.js`。


### 扩展的规则

1. 假设匹配 `widget` 目录下以及其子目录下的所有 js 文件，使用 `node-glob` 需要这么写

  ```js
  widget/{*.js,**/*.js}
  ```

  这样写起来比较麻烦，所以扩展了这块的语法，以下方式等价于上面的用法

  ```js
  widget/**.js
  ```
2. `node-glob` 中没有捕获分组，而 fis 中经常用到分组信息，如下面这种正则用法：

  ```js
  // 让 a 目录下面的 js 发布到 b 目录下面，保留原始文件名。
  fis.match(/^\/a/(.*\.js$)/i, {
    release: '/b/$1'
  });
  ```

  由于原始 `node-glob` 不支持捕获分组，所以做了对括号用法的扩展，如下用法和正则用法等价。

  ```js
  // 让 a 目录下面的 js 发布到 b 目录下面，保留原始文件名。
  fis.match('/a/(**.js)', {
    release: '/b/$1'
  });
  ```
